# 项目协作协议

**项目名称**: Personal Knowledge Base System (个人知识库智能管理系统)
**开始日期**: 2026-01-16
**协作模式**: 协作开发（AI + 人工）

> **📌 重要提示**: 本协作协议已优化结构，将频繁更新的内容分离到 `/docs` 目录下的独立文档：
> - `task-progress.md` - 任务进度跟踪（任务列表、完成状态）
> - `progress-visualization.md` - 进度可视化（进度条、完成百分比）
> - `notes-area.md` - 笔记区域（任务记录、问题总结、技术决策）

---

## 🎯 协作原则

### 1. 任务分解方式
- 每个大任务分解为 3-6 个小任务
- 每个小任务预计 5-30 分钟完成
- 一次只聚焦 1-2 个小任务，避免信息过载

### 2. 每个任务的协作流程

#### AI 的职责
- 提供清晰的任务目标和说明
- 展示 3 种完成方式选项（学习型/快速型/灵活型）
- 根据用户选择提供相应支持
- 创建必要的代码和配置文件
- 提供技术指导和最佳实践
- 协同用户完成任务
- 代码审查和优化建议
- 提供测试代码和指导
- 测试功能并报告问题
- 测试成功时提交代码，提交信息使用中文
- 更新`/docs`目录下的所有文档（task-progress.md、progress-visualization.md、notes-area.md）。注意更新一切可以更新的内容

#### 用户的职责
- 选择最适合的完成方式
- 根据指导完成任务
- 决定项目优先级和方向
- 提供反馈和需求调整

### 3. 任务完成方式选项

**A. 学习型**
- AI 详细解释技术原理和最佳实践
- 提供代码示例和注释
- 用户亲自动手编写代码
- 适合：感兴趣的技术模块、核心功能

**B. 快速型**
- AI 直接提供完整可用的代码
- 用户查看结果并进行测试
- 节省时间，快速推进项目
- 适合：不感兴趣的部分、重复性工作

**C. 灵活型**
- AI 创建核心代码框架
- 用户补充具体实现细节
- 平衡学习和效率
- 适合：中等复杂度的模块

### 4. Git 版本管理策略

#### 提交策略
- **每个子任务代码完成后进行测试，测试成功后提交代码**
- **提交信息格式**: 遵循SKILL要求

#### 同步策略
- **每个子任务完成测试后推送到远程仓库**
- **确保远程仓库始终保持最新状态**
- **避免大量未提交的代码堆积**
- **测试后提交**: 确保代码质量再提交到仓库

#### 分支策略
- **主分支 (main)**: 稳定版本
- **开发分支 (dev)**: 开发中的功能
- **功能分支 (feature/*)**: 独立功能开发
- **当前策略**: 直接在 main 分支开发，快速迭代


### 5.测试策略 
- **测试覆盖**: 完成代码后进行测试，测试成功后才能提交代码
- **灵活测试**: 根据完成的代码决定创建单元测试还是集成测试或者是进行轻量级测试
- **测试分类**:
  - 轻量级: 语法检查 + 基本验证
  - 单元测试: 核心逻辑测试
  - 集成测试: 端到端功能验证
- **工作流程**:
  ```
  完成代码 → 运行测试 → 通过测试 → 提交代码
  ```
- **测试文档位置**：`/tests` 目录下，集成测试存放在 `/tests/integration` 目录下，单元测试存放在 `/tests/unit` 目录下

---

## 🔍 用户关注点

### 重点关注的模块
1. **AI 集成**（最关注）
   - LangChain 使用
   - LLM 工厂模式
   - 多模型切换
   - RAG 实现

2. **全栈开发流程**（次关注）
   - 前后端通信
   - API 设计
   - 数据库集成
   - 部署流程

### 不太关注的模块
- 前端 UI 细节（可快速型完成）
- 基础配置文件（可快速型完成）
- 文档编写（可选）

---

## 📌 上下文管理策略

### 定期总结
每个阶段完成后，AI 将提供：
- 已完成任务的简要回顾
- 技术要点总结
- 下一个任务的预览
- 更新在笔记区域的阶段总结段落

### 关键决策记录
重要技术决策将记录在此文档：
1. **LangChain 版本**: 0.3.7（2024年12月最新稳定版）
2. **智谱AI embedding**: 使用 langchain-community 官方 ZhipuAIEmbeddings
3. **Pydantic 版本**: v2（LangChain 0.3 要求）
4. **向量存储**: ChromaDB（LangChain 原生支持）
5. **对话模型默认**: DeepSeek deepseek-chat（性价比）
6. **备用模型**: 智谱AI GLM-4.7（编码能力最强）

### 回滚机制
如果遇到问题：
- 使用 Git 回退到上一个稳定版本
- 在本文件记录问题和解决方案
- 重新评估技术方案

---

## 💬 沟通规范

### 用户指令格式
```
[任务ID] [选择方式]

示例：
1.1 A    # 任务 1.1，选择学习型
2.3 B    # 任务 2.3，选择快速型
3.2 C    # 任务 3.2，选择灵活型
```

### AI 响应格式
```
📋 任务 X.Y: [任务名称]
🎯 目标: [清晰描述]
⏱️ 预计时间: [X分钟]
💡 难度: [简单/中等/困难]

📝 技术要点:
- 要点 1
- 要点 2

💻 实施步骤:
1. 步骤 1
2. 步骤 2
3. ...

✅ 完成后请回复 "完成" 或描述遇到的问题
```

---

## 🚀 快速启动指令

### 当用户返回时
用户只需说："继续" 或 "下一个任务"
AI 将：
1. 显示当前任务列表
2. 突出显示下一个待办任务
3. 提供 3 种完成方式选项

### 当遇到问题时
用户只需说："帮助" 或 "卡住了"
AI 将：
1. 提供当前任务的详细说明
2. 分析可能的问题原因
3. 提供多个解决方案

### 当需要暂停时
用户只需说："暂停" 或 "记录当前状态"
AI 将：
1. 保存当前进度到此文档
2. 总结已完成的工作
3. 列出下一步需要做的

---

**最后更新**: 2026-01-16 17:30
**当前任务**: 阶段2完成 - 用户认证系统（所有任务完成，代码已提交）
**下一步**: 开始阶段3 - AI集成（任务3.1：创建LLM工厂类）
**文档分离**: 任务进度、进度可视化、笔记区域已分离到 `/docs` 目录下的独立文档
